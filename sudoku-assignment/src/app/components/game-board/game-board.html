<app-game-over></app-game-over>
<app-game-won></app-game-won>
@if (busyService.loading) {
  <div class="fixed inset-0 flex items-center justify-center bg-black/30 z-50">
    <mat-progress-spinner mode="indeterminate" diameter="80"></mat-progress-spinner>
  </div>
}
@else {
  <div class="flex flex-col md:flex-row gap-5 justify-center items-start mt-8 px-4">
    <!-- Mistakes counter -->
    <div class="text-base sm:text-lg font-semibold mb-2"
         [ngClass]="{'text-red-600': sudokuStateService.mistakes()! <= 0}">
      Mistakes left: {{ sudokuStateService.mistakes() }}
    </div>

    <!-- Sudoku board -->
    @if (sudokuStateService.apiBoard()) {
      <div class="w-full max-w-[500px] aspect-square border-4 border-black grid grid-rows-9 grid-cols-9">
        @for (row of sudokuStateService.gameBoard(); track $index){
          @for (cell of row; track $index){
            <input type="number"
              min="1" max="9"
              class="w-full h-full text-center text-sm sm:text-lg border border-gray-300 no-spinner cursor-pointer"
              [ngClass]="{
                'border-r-4 border-black': (cell.column + 1) % 3 === 0 && cell.column !== 8,
                'border-b-4 border-black': (cell.row + 1) % 3 === 0 && cell.row !== 8,
                'text-red-500': cell.invalid,
                'bg-gray-200': selectedCell.row == cell.row && selectedCell.column === cell.column,
                'bg-gray-100': isCellInHighlight(cell)
              }"
              [value]="cell.value || ''"
              [readOnly]="!cell.active"
              (keydown)="onKeyDown($event)"
              (input)="onCellInput($event,cell.row,cell.column,cell)"
              (click)="selectedCell = {row:cell.row,column:cell.column}"
              [attr.data-cell]="cell.row + '-' + cell.column">
          }
          
        }
        
      </div>
      <app-game-controls [selectedCell]="selectedCell"></app-game-controls>
    }
    </div>
  }
  
